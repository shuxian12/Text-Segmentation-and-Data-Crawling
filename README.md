# Text Segmentation and Data Crawling

[![hackmd-github-sync-badge](https://hackmd.io/Uof6g1mXRPmCQqsl1JsW8w/badge)](https://hackmd.io/Uof6g1mXRPmCQqsl1JsW8w)

## Getting Started

### Prerequisites

Before you begin, ensure you have the following:

- Python 3.9+
  - **Notice:** Python and the pip package manager must be in the path in your computer for the setup scripts to work.
- Git
- Azure account (with sufficient permissions to create and manage resources)
- Azure Developer CLI
- OpenAI API key

You also need to manually creates Azure Web Service, Azure OpenAI Service, and Azure Cognitive Search Service. If you don't have any pre-existing Azure services, create those services [here](https://portal.azure.com) and follow the guides:
  - [Azure Web Service](https://learn.microsoft.com/en-us/azure/app-service/quickstart-python?tabs=flask%2Cwindows%2Cazure-cli%2Cvscode-deploy%2Cdeploy-instructions-azportal%2Cterminal-bash%2Cdeploy-instructions-zip-azcli)
  - [Azure OpenAI](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/create-resource?pivots=web-portal)
  - [Azure Cognitive Search](https://learn.microsoft.com/en-us/azure/search/search-get-started-portal)
    - `AZURE_KEY_CREDENTIAL` can be found under your Search Service $\rightarrow$ Settings $\rightarrow$ Keys $\rightarrow$ **`Primary admin key`**

1. Clone the repo
    ```shell
    git clone https://github.com/samuellee77/azure-openai-chat-forum-bot.git
    ```
2. Install python package
    ```shell
    pip install -r requirements.txt
    ```


<!-- GETTING STARTED -->
## Data Crawling

### How to use

#### **1. Download single page**
> **Note**
> Need help? Run `python download_wiki.py --help` to see the help message.
```shell
python download_single_page.py --url {target_url} --folder {folder_path} --type 'wiki
```
* **`parameter`**
  * `--url`: target url
  * `--folder`: folder path to save the downloaded page
  * `--type`: type of the page, currently only support `wiki` and `forum`. If not specified, it will download the whole page from the url.

#### **2. Download whole forum topics**
- Download whole forum topics (you need to change `url` variable in the script):
```shell
python forum_scraper.py
```

#### **3. Download whole wiki pages**
> **Note**
> Remember to fill in correct url and folder path in the shell command.
> Need help? Run `python download_wiki.py --help` to see the help message.

```shell
python download_wiki.py --url 'http://ess-wiki.advantech.com.tw/view/RISC' --folder 'download_wiki/' --new
```

* **`parameter`**
  * `--url`: target url
  * `--folder`: folder path to save the downloaded page
  * `-n`, `--new`: if specified, it will create a new folder and a new `site_change.json` file.
  * `-u`, `--update`: Check if there is any update in the wiki page, and update the `site_change.json` file. New or changed files will be saved in `FOLDER/update/`.
  * `site_change.json` file is used to record the changes of the wiki page. 

## Text Segmentation and Upload to Azure Service

> **Note**\
> `predocs.py` will segment the text to fit the **Index** of Azure Cognitive Search Service. Optionally, it can also upload the whole file to **Container** on Azure Blob Storage.\
> Need help? Run `python predocs.py --help` to see the help message and the description of each parameter.

### How to use
1. Please check the environment variables in `.env` are all correct.
2. There are two ways to run code:
    - Run the python script:
        By default, it will upload data to Azure Blob Storage and Azure Cognitive Search Service, and remove the url and image in markdown file before text segmentation.
        So, if want to control the behavior, please go to the `predocs.sh` to change the parameters at the second last line.
        ```shell
        python predocs.py --data_path {your_data_path}
        ```
    - Directly run the `predocs.py` code:
        > Be aware that you have to enter the correct parameters in the code below by yourself.
        1. Upload Search Service and Blob Storage simultaneously:
            ```shell
            python prepdocs.py "DATA_PATH" --searchservice "AZURE_SEARCH_SERVICE" --index "AZURE_SEARCH_INDEX" --tenantid "TENANT_ID" --searchkey "AZURE_KEY_CREDENTIAL" --storageaccount "AZURE_STORAGE_ACCOUNT" --container "AZURE_STORAGE_CONTAINER" --storagekey "AZURE_STORAGE_KEY" --tenantid "TTENANT_ID" -v --remove_image --remove_href
            ```
        2. Only upload to Search Service:
            ```shell
            python prepdocs.py "DATA_PATH" --searchservice "AZURE_SEARCH_SERVICE" --index "AZURE_SEARCH_INDEX" --tenantid "TENANT_ID" --searchkey "AZURE_KEY_CREDENTIAL" -v --remove_image --skipblobs
            ```
        3. `prepdocs.py` doesn't support only upload to Blob Storage.
            - If you want to upload to Blob Storage only, please do it manually on Azure Portal.
3. Text segmentation mamually:
    - If you want to segment the text manually, you have to arrange your data to the below format.
    - If you want to see the original markdown file of below json file, please go to `data\DeviceOn Getting Started.md`.
    > **Note**\
    > `id`, `title`, `content`, `markdown`, `sourcefile` are required.
    ```json
    {
        "id": "file-DeviceOn_Getting_Started_md-4465766963654F6E2047657474696E6720537461727465642E6D64-page-0",
        "title": "DeviceOn Getting Started",
        "content": "DeviceOn Getting Started\nStep 1: Install the DeviceOn Package on Your System\nCopy the installation file (DeviceOn_Server_Setup_4.7.x.exe) to your target system and run it as administrator.\nClick “Next” to start the installation process.\nSelect “I Accept the terms in the License Agreement” and click “Next”\nSelect the “Installation Folder” for DeviceOn Server and click “Next”\nEnter “Public IP” or “Domain Name” for this physical/virtual machine and click “Next”. This information is required for “Edge Device” connectivity, please make sure your device is reachable under this IP or Domain Name.\nNote: You can start a Windows command prompt and type “ipconfig” to retrieve your IP address(es) on this physical/virtual machine.\nYou will need to configure the HTTP port number that is used for web browser-based access the DeviceOn management portal. The default port is 8080, but you can select any other port as long as it does not conflict with any other application or service. Click “Next”.\nConfigure the password of the relational database (PostgreSQL) that DeviceOn uses to manage account, device, permission, and relation data. The default account name is “postgres” and the password should follow below guideline.\nStrong Password Rules:\nMinimum eight characters, at least one number, one lowercase letter, one uppercase letter, and one special character (Blank character, Backslash(\\), Double quotes(\") are prohibited)\nConfigure the password of the NoSQL database (MongoDB) that stores device sensor data. The default account and database is “wisepaas/WISE-PaaS”. This password should also follow strong password rules as outlined above.\nSelect the database installation path and cache size of MongoDB and click “Next”. A larger cache size will result in better performance. For more information on this parameter, please referend to the official documentation\nEnable capped collections for data recycling and set the size for each collections. Capped collections work in a way similar to circular buffers: once collection files its allocated spce, it make room for new documentas by overwriting the oldest documents in the collection.\n:::warning\n:warning: The charateristic of capped cannot be disabled, if you enable the collection at first.\n:::\nConfigure the password of the root account (dummy name “root@advantech.com.tw”) and click “Next”. This root account has the highest permission level and is used to log in to the DeviceOn web service and create other user accounts.\nSet up the HTTP service port for Grafana dashboard. The default user name and password is admin/admin. You will be able to modify this at the first login.\nSet up FTP service port for application (App Store), device log storage.\nDeviceOn license is tied to network inteface. The above lists all choose-able network cards informations. To install DeviceOn, you have to determine which network card to be tied to. Choosing a connected and physical interface over a virtual one is highly recommended to prevent potential issue that DeviceOn may encounter in the future.\nClick “Install” to begin the installation.\nClick the “Finish” to exit the program.\nStep 2: Launch DeviceOn Web Service Shortcut on Desktop\nTwo shortcuts will be generated on the desktop - one is for the DeviceOn web portal and the other one is for the Grafana dashboard.\nClick the “DeviceOn Server” shortcut in order to launch a browser and to start device operation and management. It is recommended to use Chrome for the best user experience.",
        "category": null,
        "sourcepage": "DeviceOn Getting Started-0.md",
        "sourcefile": "DeviceOn Getting Started.md",
        "headings": "DeviceOn Server Installation | Setup Standalone Version on Windows (On-premises)",
        "markdown": "# DeviceOn Getting Started  \n[TOC]\n## DeviceOn Server Installation\n### Setup Standalone Version on Windows (On-premises)\n#### Step 1: Install the DeviceOn Package on Your System\n> Copy the installation file (**DeviceOn_Server_Setup_4.7.x.exe**) to your target system and run it as administrator.\n> Click “**Next”** to start the installation process.\n> Select “**I Accept the terms in the License Agreement**” and click “**Next**”\n> Select the “**Installation Folder**” for DeviceOn Server and click “**Next**”\n> Enter “**Public IP**” or “**Domain Name**” for this physical/virtual machine and click “**Next**”. This information is required for “Edge Device” connectivity, please make sure your device is reachable under this IP or Domain Name.\nNote: You can start a Windows command prompt and type “ipconfig” to retrieve your IP address(es) on this physical/virtual machine.\n> You will need to configure the HTTP port number that is used for web browser-based access the DeviceOn management portal. The default port is 8080, but you can select any other port as long as it does not conflict with any other application or service. Click “**Next**”.\n> Configure the password of the relational database (PostgreSQL) that DeviceOn uses to manage account, device, permission, and relation data. The default account name is “postgres” and the password should follow below guideline.\n**Strong Password Rules**:\n> *Minimum eight characters, at least one number, one lowercase letter, one uppercase letter, and one special character (Blank character, Backslash(\\\\), Double quotes(\") are prohibited)*\n> Configure the password of the NoSQL database (MongoDB) that stores device sensor data. The default account and database is “wisepaas/WISE-PaaS”. This password should also follow strong password rules as outlined above.\n> Select the database installation path and cache size of MongoDB and click “**Next**”. A larger cache size will result in better performance. For more information on this parameter, please referend to the [official documentation](https://docs.mongodb.com/manual/reference/configuration-options/#storage.wiredTiger.engineConfig.cacheSizeGB)\n> Enable capped collections for data recycling and set the size for each collections. Capped collections work in a way similar to circular buffers: once collection files its allocated spce, it make room for new documentas by overwriting the oldest documents in the collection.\n:::warning\n:warning: The charateristic of capped cannot be disabled, if you enable the collection at first.\n:::\n> Configure the password of the root account (dummy name “root@advantech.com.tw”) and click “Next”. This root account has the highest permission level and is used to log in to the DeviceOn web service and create other user accounts.\n> Set up the HTTP service port for Grafana dashboard. The default user name and password is admin/admin. You will be able to modify this at the first login.\n> Set up FTP service port for application (App Store), device log storage.\n> DeviceOn license is tied to network inteface. The above lists all choose-able network cards informations. To install DeviceOn, you have to determine which network card to be tied to. Choosing a connected and physical interface over a virtual one is highly recommended to prevent potential issue that DeviceOn may encounter in the future.\n> Click “**Install**” to begin the installation.\n> Click the “Finish” to exit the program.\n####  Step 2: Launch DeviceOn Web Service Shortcut on Desktop\n> Two shortcuts will be generated on the desktop - one is for the DeviceOn web portal and the other one is for the Grafana dashboard.\n> Click the “**DeviceOn Server**” shortcut in order to launch a browser and to start device operation and management. It is recommended to use **Chrome** for the best user experience."
    },
    {
        "id": "file-DeviceOn_Getting_Started_md-4465766963654F6E2047657474696E6720537461727465642E6D64-page-1",
        "title": "DeviceOn Getting Started",
        "content": "If you are interested in DeviceOn and used to Linux platform, On-Premise, we also provide an installer for Ubuntu Linux (one of the most popular Linux distribution). This section will guide you how to install DeviceOn on Ubuntu Linux. Note here that:\n- The DeviceOn Ubuntu Linux installer is named something like \"DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run\". To acquire the installer and ensure having the latest version, please contact us.\n- If you are running the installer with an account other than \"root\", you should use \"sudo\" command to obtain higher privileges, or the installation may fail at any step.\nStep 1: Open a terminal\nThe installer runs in CLI (Command Line Interface) mode. As such, open a terminal preferable for you.\nStep 2: Copy the installer to target host\nUse the way you like to copy the installer to the target host.\nStep 3: Set the installer as executable\nIn the terminal, run \"chmod 0755 DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run\" so that the installer as an executable file under Ubuntu Linux.\nStep 4: Running the installer\nChange your working directory to where the installer is and run \"./DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run \". You may need to run \"sudo ./DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run \" to acquire higher privileges if you were logged in as a normal user.\nStep 5: Answering some questions\nThroughout installation process, it's necessary to answer some questions to complete the installation:\nA. The password of user postgres to login PostgreSQL database.\nWhen you run into this step the question shows like above. Just input the password you would like to use to login PostgreSQL database for “postgres” account.\nB.  The password of user “wisepaas” to login MongoDB database.\nWhen you run into this step the question shows like above. Just input the password you would like to use to login MongoDB database for “wisepaas” account.\nC.  The valid IP or host name of the target host.\nWhen you run into this step the question shows like above. Just input the IP address of the target host. A hostname (even a FQDN) is also acceptable if you are sure that agents can connect to via the name you provide.\nD.  If turn MongoDB capped functionality on or not.\nWhen you run into this step the question shows like above. Just input “yes” or “no” to enable or disable “capped” functionality. If you answer “yes”, a subsequent question followed to ask you “how much capped size, in MB, to be used? “. Just input the size, in MB, you want to use in “capped” functionality in MongoDB database.\nCapped collections are fixed-size collections that support high-throughput operations that insert and retrieve documents based on insertion order. Capped collections work in a way similar to circular buffers: once a collection fills its allocated space, it makes room for new documents by overwriting the oldest documents in the collection.\nE.  The password of user “root\\@advantech.com.tw” to login DeviceOn portal, and the rule should follow below guideline.\nStrong Password Rules:\nMinimum eight characters, at least one number, one lowercase letter, one uppercase letter, and one special character (Blank character, Backslash(\\), Double quotes(\") are prohibited)\nWhen you run into this step the question shows like above. Just input the password you would like to use to login DeviceOn portal for “root\\@advantech.com.tw” account.\nFinally, a workable DeviceOn server should be there the target host. Open a browser and input http://{IP-USED-IN-QUESTION-C}, you should see the DeviceOn login page.",
        "category": null,
        "sourcepage": "DeviceOn Getting Started-1.md",
        "sourcefile": "DeviceOn Getting Started.md",
        "headings": "Setup Standalone Version on Linux (On-premises) | DeviceOn Server Installation",
        "markdown": "## DeviceOn Server Installation\n### Setup Standalone Version on Linux (On-premises)\nIf you are interested in DeviceOn and used to Linux platform, On-Premise, we also provide an installer for Ubuntu Linux (one of the most popular Linux distribution). This section will guide you how to install DeviceOn on Ubuntu Linux. Note here that:\n- The DeviceOn Ubuntu Linux installer is named something like \"**DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run**\". To acquire the installer and ensure having the latest version, please contact us.\n- If you are running the installer with an account other than \"root\", you should use \"**sudo**\" command to obtain higher privileges, or the installation may fail at any step.\n#### Step 1: Open a terminal\n> The installer runs in CLI (Command Line Interface) mode. As such, open a terminal preferable for you.\n#### Step 2: Copy the installer to target host\n> Use the way you like to copy the installer to the target host.\n#### Step 3: Set the installer as executable\n>　In the terminal, run \"**chmod 0755 DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run**\" so that the installer as an executable file under Ubuntu Linux.\n#### Step 4: Running the installer\n> Change your working directory to where the installer is and run \"**./DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run** \". You may need to run \"**sudo ./DeviceOn_Server_Ubuntu 18.04_x64_4.7.x.run** \" to acquire higher privileges if you were logged in as a normal user.\n#### Step 5: Answering some questions\n> Throughout installation process, it's necessary to answer some questions to complete the installation:\nA. The password of user **postgres** to login PostgreSQL database.\nWhen you run into this step the question shows like above. Just input the password you would like to use to login PostgreSQL database for “**postgres**” account.\nB.  The password of user “**wisepaas**” to login MongoDB database.\nWhen you run into this step the question shows like above. Just input the password you would like to use to login MongoDB database for “**wisepaas**” account.\nC.  The valid IP or host name of the target host.\nWhen you run into this step the question shows like above. Just input the IP address of the target host. A hostname (even a FQDN) is also acceptable if you are sure that agents can connect to via the name you provide.\nD.  If turn MongoDB capped functionality on or not.\nWhen you run into this step the question shows like above. Just input “**yes**” or “**no**” to enable or disable “capped” functionality. If you answer “yes”, a subsequent question followed to ask you “how much capped size, in MB, to be used? “. Just input the size, in MB, you want to use in “capped” functionality in MongoDB database.\n[Capped collections](https://docs.mongodb.com/manual/reference/glossary/#term-capped-collection) are fixed-size collections that support high-throughput operations that insert and retrieve documents based on insertion order. Capped collections work in a way similar to circular buffers: once a collection fills its allocated space, it makes room for new documents by overwriting the oldest documents in the collection.\nE.  The password of user “**root\\@advantech.com.tw**” to login DeviceOn portal, and the rule should follow below guideline.\n**Strong Password Rules**:\n*Minimum eight characters, at least one number, one lowercase letter, one uppercase letter, and one special character (Blank character, Backslash(\\\\), Double quotes(\") are prohibited)*\nWhen you run into this step the question shows like above. Just input the password you would like to use to login DeviceOn portal for “**root\\@advantech.com.tw**” account.\nFinally, a workable DeviceOn server should be there the target host. Open a browser and input http://{IP-USED-IN-QUESTION-C}, you should see the DeviceOn login page."
    },
    {
        "id": "file-DeviceOn_Getting_Started_md-4465766963654F6E2047657474696E6720537461727465642E6D64-page-2",
        "title": "DeviceOn Getting Started",
        "content": "Step 1: \nPlease enter to Azure Marketplace and click \"GET IT NOW\"\nSign in your Account\nYou will enter to Azure portal and please click on Start with pre-set configuration to be quick deployment\nThis page includes our recommended configuration for DeviceOn Server, you can just click on Continue to create VM, following the default setting.\nIn this page, please note that the red star parts info are MUST.\n- Select your Azure Subscription\n- Create a new resource group or pick-up\n- Define your Virtual Machine name\n- Select the Virtual Machine region, you can pick one which is the nearest one to your location\n- Select DeviceOn as default Image\n- Here you need to create the Username and remember the Password which is to secure this DeviceOn VM (Remote Desktop Used)\nThen click Next to move on, or you can directly click “Review + Create”, then all the following items will be set as default.\nBy using the default disk Premium SSD, then click Next to move on.\nSet the network interface\n- Select the one you just defined in previous grouping or create new\nIn this page, you can schedule the power management of VM for reducing the unnecessary cost\n- Auto shut-down schedule (please make sure the time zone is correct)\n- Email account\nBasically, you can click Review + Create if you don’t need advanced setting. VM will be validating and creating within 5 minutes.\nA few minutes later, you can see below picture that VM has been created.\nClick “Go to resource” to review more detail.\nAfter deployment, please click on \"Connect\" to remote login to VM via Microsoft Remote Desktop. The password that you configure on Step 1. There is a Quick Start Guide on the desktop and include the random password to access DeviceOn Web Service.\nStep 2: Access DeviceOn Web Service\nPlease copy the public address first from Azure VM, and open Microsoft Edge or other browsers to paste the IP address (Suggest using Microsoft Edge for best experience)\nEnter to DeviceOn main page, please follow the steps to finish the basic questionnaire and then confirm the related policy and agreement. (As below pictures)\nEnter the default account and password (through Quick Start Guide)\n- Account: root@advantech.com.tw\n- Password: *\nNote: Please remember to modify your own password after log-in.*",
        "category": null,
        "sourcepage": "DeviceOn Getting Started-2.md",
        "sourcefile": "DeviceOn Getting Started.md",
        "headings": "Deploy DeviceOn from Azure Marketplace | Cloud Deployment from Azure/AWS",
        "markdown": "## Cloud Deployment from Azure/AWS\n### Deploy DeviceOn from Azure Marketplace\n#### Step 1: Deploy DeviceOn from Azure Marketplace\n> Please enter to [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/advantech.deviecon_on_windows_vm_v1?tab=Overview) and click \"GET IT NOW\"\n> Sign in your Account\n> You will enter to Azure portal and please click on **Start with pre-set configuration** to be quick deployment\n> This page includes our recommended configuration for DeviceOn Server, you can just click on **Continue to create VM**, following the default setting.\n> In this page, please note that the red star parts info are MUST.\n- Select your Azure Subscription\n- Create a new resource group or pick-up\n- Define your Virtual Machine name\n- Select the Virtual Machine region, you can pick one which is the nearest one to your location\n- Select **DeviceOn** as default Image\n- Here you need to create the **Username** and remember the **Password** which is to secure this DeviceOn VM (**Remote Desktop Used**)\n> Then click Next to move on, or you can directly click “Review + Create”, then all the following items will be set as default.\n> By using the default disk Premium SSD, then click **Next** to move on.\n> Set the network interface\n- Select the one you just defined in previous grouping or create new\n> In this page, you can schedule the power management of VM for reducing the unnecessary cost\n- Auto shut-down schedule (please make sure the time zone is correct)\n- Email account\n> Basically, you can click **Review + Create** if you don’t need advanced setting. VM will be validating and creating within 5 minutes.\n> A few minutes later, you can see below picture that VM has been created.\n> Click “Go to resource” to review more detail.\n> After deployment, please click on \"**Connect**\" to remote login to VM via Microsoft Remote Desktop. The password that you configure on Step 1. There is a **Quick Start Guide** on the desktop and include the random password to access DeviceOn Web Service.\n#### Step 2: Access DeviceOn Web Service\n> Please copy the public address first from Azure VM, and open Microsoft Edge or other browsers to paste the IP address (Suggest using Microsoft Edge for best experience)\n> Enter to DeviceOn main page, please follow the steps to finish the basic questionnaire and then confirm the related policy and agreement. (As below pictures)\n> Enter the default account and password (through **Quick Start Guide**)\n- Account: root@advantech.com.tw\n- Password: ********\n*Note: Please remember to modify your own password after log-in.*"
    },
    {
        "id": "file-DeviceOn_Getting_Started_md-4465766963654F6E2047657474696E6720537461727465642E6D64-page-3",
        "title": "DeviceOn Getting Started",
        "content": "Step 1: \nPlease enter to AWS Marketplace and click on the \"Continue to Subscribe\"\nSign in your AWS account.\nClick on the \"Continue to Configuration\"\nCongigure this DeviceOn software and click on the \"Continue to Launch\"\n1. Deleviery Method: 64-bit (x86) Amazon Machine Image (AMI)\n2. Software Version: 4.2.3 (May, 22, 2020)\n3. Region: Select the Region that the nearest to your location.\nLaunch this DeviceOn software\n1. Choose Action: Launch from Website\n2. EC2 Instance Type: t2.large (Recommand select higher than t2.large for better performance.)\n3. VPC Settings: default vpc\n4. Subnet Settings: default subnet\n5. Security Group Settings:\nCreate a security group based on our setting, enter name, description of this security group.\n6. Key Pair Settings\nCreate a key pair in EC2, enter name and select file format as \"pem\". The key pair used to get the password of Remote Desktop.\n7. Click on the \"Launch\" to deploy EC2 machine.\nStep 2: Login EC2 Virtual Machine\nAfter deployment, please enter to AWS EC2 Console, select your instance and get the connect remote desktop and password.\nIn order to retrieve your password you will need to specify the path of this Key Pair (DeviceOnKey.pem) on your machine.\nThere is a Quick Start Guide on the desktop and include the random password to access DeviceOn Web Service.\nStep 3: Login DeviceOn Web Service\nEnter to DeviceOn main page (Suggest using Microsoft Edge or Google Chrome for best experience), please follow the steps to finish the basic questionnaire and then confirm the related policy and agreement. (As below pictures)\nEnter the default account and password (through Quick Start Guide)\n- Account: root@advantech.com.tw\n- Password: *\nNote: Please remember to modify your own password after log-in.*\nThis document tries to describe, and guide you, how to deploy DeviceOn on Azure cloud. The version is focused on Azure components to integrate to provide security, scalability and high availability.\nMicrosoft Azure provides lot’s of cloud services with security, scalability and high available. Based on Azure components, DeviceOn could focus on functionalities for device management and data acquisition. We fully integrate with below services:\n- Azure Application Gateway (WAF protection and traffic load balancer), Optional\n- Kubernetes (Container Management)\n- Azure AD (Authentication), Optional\n- Cosmos DB, Azure PostgreSQL (Database)\n- Azure Function, IoTHub (Secure Device Connection)\n- Stream Analytics, Event Hub, Service Bus (Message Bus and Filter)\nWhen you build on Azure’s secure foundation, you accelerate your move to the cloud by achieving compliance more readily, allowing you to enable privacy-sensitive cloud scenarios, such as financial and health service, with confidence.\nTo achieve the goal to deploy DeviceOn, some resources have to be acquired and preconditions must be met as well.\n- An active Azure subscription.\n- An Azure CLI installed on your laptop, please refer to Azure documentation to download and setup. The Azure CLI is available to install in Windows, macOS and Linux environments. It can also be run in a Docker container and Azure Cloud Shell.\nSecond option, if you don't want to install Azure CLI, you can also adopt Azure Cloud Shell, please refer to Microsoft documentation.",
        "category": null,
        "sourcepage": "DeviceOn Getting Started-3.md",
        "sourcefile": "DeviceOn Getting Started.md",
        "headings": "Deploy DeviceOn from AWS Marketplace | Deploy Enterprise Version on Azure Kubernetes | Cloud Deployment from Azure/AWS | Prerequisites",
        "markdown": "## Cloud Deployment from Azure/AWS\n### Deploy DeviceOn from AWS Marketplace\n#### Step 1: Deploy DeviceOn from AWS Marketplace\n> Please enter to [AWS Marketplace](https://aws.amazon.com/marketplace/pp/B08972SVHN) and click on the \"**Continue to Subscribe**\"\n> Sign in your AWS account.\n> Click on the \"**Continue to Configuration**\"\n> Congigure this DeviceOn software and click on the \"**Continue to Launch**\"\n1. Deleviery Method: **64-bit (x86) Amazon Machine Image (AMI)**\n2. Software Version: **4.2.3 (May, 22, 2020)**\n3. Region: Select the Region that the nearest to your location.\n> Launch this DeviceOn software\n1. Choose Action: **Launch from Website**\n2. EC2 Instance Type: **t2.large** (Recommand select higher than t2.large for better performance.)\n3. VPC Settings: **default vpc**\n4. Subnet Settings: **default subnet**\n5. Security Group Settings:\n> Create a security group based on our setting, enter name, description of this security group.\n6. Key Pair Settings\n> Create a key pair in EC2, enter name and select file format as \"**pem**\". The key pair used to get the password of Remote Desktop.\n7. Click on the \"**Launch**\" to deploy EC2 machine.\n#### Step 2: Login EC2 Virtual Machine\n> After deployment, please enter to AWS EC2 Console, select your instance and get the connect remote desktop and password.\n> In order to retrieve your password you will need to specify the path of this **Key Pair (DeviceOnKey.pem)** on your machine.\n> There is a **Quick Start Guide** on the desktop and include the random password to access DeviceOn Web Service.\n#### Step 3: Login DeviceOn Web Service\n> Enter to DeviceOn main page (Suggest using Microsoft Edge or Google Chrome for best experience), please follow the steps to finish the basic questionnaire and then confirm the related policy and agreement. (As below pictures)\n> Enter the default account and password (through **Quick Start Guide**)\n- Account: root@advantech.com.tw\n- Password: ********\n**Note: Please remember to modify your own password after log-in.**\n### Deploy Enterprise Version on Azure Kubernetes\n> This document tries to describe, and guide you, how to deploy DeviceOn on Azure cloud. The version is focused on Azure components to integrate to provide security, scalability and high availability.\n> Microsoft Azure provides lot’s of cloud services with security, scalability and high available. Based on Azure components, DeviceOn could focus on functionalities for device management and data acquisition. We fully integrate with below services:\n- <font color=gray>Azure Application Gateway (WAF protection and traffic load balancer), Optional</font>\n- Kubernetes (Container Management)\n- <font color=gray>Azure AD (Authentication), Optional</font>\n- Cosmos DB, Azure PostgreSQL (Database)\n- Azure Function, IoTHub (Secure Device Connection)\n- Stream Analytics, Event Hub, Service Bus (Message Bus and Filter)\n> When you build on Azure’s secure foundation, you accelerate your move to the cloud by achieving compliance more readily, allowing you to enable privacy-sensitive cloud scenarios, such as financial and health service, with confidence.\n#### Prerequisites\nTo achieve the goal to deploy DeviceOn, some resources have to be acquired and preconditions must be met as well.\n- An active Azure subscription.\n- An **Azure CLI** installed on your laptop, please refer to [Azure documentation](https://docs.microsoft.com/zh-tw/cli/azure/install-azure-cli) to download and setup. The Azure CLI is available to install in Windows, macOS and Linux environments. It can also be run in a Docker container and Azure Cloud Shell.\nSecond option, if you don't want to install Azure CLI, you can also adopt **Azure Cloud Shell**, please refer to [Microsoft documentation](https://docs.microsoft.com/en-us/azure/cloud-shell/overview)."
    }
    ```